2023-04-02 19:50:33.470717: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
wandb: Tracking run with wandb version 0.14.0
wandb: Run data is saved locally in /home/klg6z/work/TransformerXL/STR_XL/Training/wandb/run-20230402_195039-36kufc1f
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run 1 250
wandb: ‚≠êÔ∏è View project at https://wandb.ai/kendragivens/StrXL
wandb: üöÄ View run at https://wandb.ai/kendragivens/StrXL/runs/36kufc1f
wandb: Downloading large artifact nachusa-dna:latest, 4079.09MB. 420 files... 
wandb: \ 1 of 420 files downloaded...wandb: | 26 of 420 files downloaded...wandb: / 44 of 420 files downloaded...wandb: - 58 of 420 files downloaded...wandb: \ 63 of 420 files downloaded...wandb: | 65 of 420 files downloaded...wandb: / 69 of 420 files downloaded...wandb: - 87 of 420 files downloaded...wandb: \ 114 of 420 files downloaded...wandb: | 121 of 420 files downloaded...wandb: / 127 of 420 files downloaded...wandb: - 137 of 420 files downloaded...wandb: \ 149 of 420 files downloaded...wandb: | 164 of 420 files downloaded...wandb: / 176 of 420 files downloaded...wandb: - 183 of 420 files downloaded...wandb: \ 190 of 420 files downloaded...wandb: | 196 of 420 files downloaded...wandb: / 201 of 420 files downloaded...wandb: - 227 of 420 files downloaded...wandb: \ 235 of 420 files downloaded...wandb: | 247 of 420 files downloaded...wandb: / 261 of 420 files downloaded...wandb: - 271 of 420 files downloaded...wandb: \ 295 of 420 files downloaded...wandb: | 310 of 420 files downloaded...wandb: / 329 of 420 files downloaded...wandb: - 358 of 420 files downloaded...wandb: \ 376 of 420 files downloaded...wandb: | 391 of 420 files downloaded...wandb: / 401 of 420 files downloaded...wandb: - 410 of 420 files downloaded...wandb: \ 419 of 420 files downloaded...wandb:   420 of 420 files downloaded.  
Done. 0:0:5.0
wandb:   5 of 5 files downloaded.  
Restoring previous model...
945
Using GPU Strategy. Selected GPUs: [0]
Sample './artifacts/nachusa-dna:v0/Wes7-PCRblank1_S8_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wes24-PCRblank2_S25_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wes44-PCRblank3_S45_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wes7-PCRblank1_S8_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wesley049-SB-100420_S188_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wes24-PCRblank2_S25_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wesley056-NegCtrl_S195_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Traceback (most recent call last):
  File "/home/klg6z/work/TransformerXL/STR_XL/Training/StrXL_Training.py", line 134, in <module>
    sys.exit(tfu.scripting.boot(main, sys.argv))
  File "/home/klg6z/.local/lib/python3.10/site-packages/tf_utilities/scripting.py", line 106, in boot
    return job(*args, **kwargs) or 0
  File "/home/klg6z/work/TransformerXL/STR_XL/Training/StrXL_Training.py", line 129, in main
    train(config, model_path)
  File "/home/klg6z/work/TransformerXL/STR_XL/Training/StrXL_Training.py", line 111, in train
    tfu.scripting.run_safely(model.fit, x=train_dataset, validation_data=val_dataset, epochs=config.epochs + config.initial_epoch, initial_epoch=config.initial_epoch, verbose=1, callbacks=callbacks)
  File "/home/klg6z/.local/lib/python3.10/site-packages/tf_utilities/scripting.py", line 227, in run_safely
    return fn(*args, **kwargs)
  File "/home/klg6z/.local/lib/python3.10/site-packages/wandb/integration/keras/keras.py", line 172, in new_v2
    for cbk in cbks:
TypeError: 'WandbCallback' object is not iterable
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.000 MB of 0.000 MB uploaded (0.000 MB deduped)wandb: \ 0.043 MB of 10.548 MB uploaded (0.000 MB deduped)wandb: | 10.548 MB of 10.548 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run summary:
wandb:                      best_epoch 910
wandb:                   best_val_loss 1.5892
wandb:                           epoch 944
wandb:                            loss 1.77586
wandb:     sparse_categorical_accuracy 0.4725
wandb:                        val_loss 2.34467
wandb: val_sparse_categorical_accuracy 0.32
wandb: 
wandb: üöÄ View run 1 250 at: https://wandb.ai/kendragivens/StrXL/runs/36kufc1f
wandb: Synced 3 W&B file(s), 0 media file(s), 0 artifact file(s) and 1 other file(s)
wandb: Find logs at: ./wandb/run-20230402_195039-36kufc1f/logs
