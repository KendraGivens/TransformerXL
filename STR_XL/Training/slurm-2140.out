2023-05-07 20:22:41.844177: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
wandb: wandb version 0.15.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.14.0
wandb: Run data is saved locally in /home/klg6z/work/TransformerXL/STR_XL/Training/wandb/run-20230507_202247-9lpnu2gw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run robust-durian-59
wandb: â­ï¸ View project at https://wandb.ai/kendragivens/StrXL_Compressed
wandb: ðŸš€ View run at https://wandb.ai/kendragivens/StrXL_Compressed/runs/9lpnu2gw
wandb: Downloading large artifact nachusa-dna:latest, 4079.09MB. 420 files... 
wandb: \ 1 of 420 files downloaded...wandb: | 32 of 420 files downloaded...wandb: / 61 of 420 files downloaded...wandb: - 63 of 420 files downloaded...wandb: \ 65 of 420 files downloaded...wandb: | 70 of 420 files downloaded...wandb: / 90 of 420 files downloaded...wandb: - 112 of 420 files downloaded...wandb: \ 126 of 420 files downloaded...wandb: | 131 of 420 files downloaded...wandb: / 133 of 420 files downloaded...wandb: - 141 of 420 files downloaded...wandb: \ 155 of 420 files downloaded...wandb: | 158 of 420 files downloaded...wandb: / 173 of 420 files downloaded...wandb: - 184 of 420 files downloaded...wandb: \ 189 of 420 files downloaded...wandb: | 202 of 420 files downloaded...wandb: / 212 of 420 files downloaded...wandb: - 220 of 420 files downloaded...wandb: \ 228 of 420 files downloaded...wandb: | 242 of 420 files downloaded...wandb: / 254 of 420 files downloaded...wandb: - 268 of 420 files downloaded...wandb: \ 283 of 420 files downloaded...wandb: | 307 of 420 files downloaded...wandb: / 323 of 420 files downloaded...wandb: - 353 of 420 files downloaded...wandb: \ 384 of 420 files downloaded...wandb: | 392 of 420 files downloaded...wandb: / 403 of 420 files downloaded...wandb: - 412 of 420 files downloaded...wandb:   420 of 420 files downloaded.  
Done. 0:0:5.0
wandb:   5 of 5 files downloaded.  
['StrXL_Compressed_Training.py', '--dataset-artifact', 'sirdavidludwig/nachusa-dna/nachusa-dna:latest', '--encoder-artifact', 'sirdavidludwig/dnabert-pretrain/dnabert-pretrain-64dim:latest', '--wandb-project', 'StrXL_Compressed', '--save-to', 'StrXL_Compressed_{seed}_{mem_len}_{num_compressed_seeds}', '--mem_len', '250', '--compressed_len', '250', '--num_compressed_seeds', '50', '--num_induce', '0', '--gpus', '0', '--seed', '1', '--epochs', '750'] Namespace(gpus=[0], dataset_path=None, dataset_artifact='sirdavidludwig/nachusa-dna/nachusa-dna:latest', encoder_path=None, encoder_artifact='sirdavidludwig/dnabert-pretrain/dnabert-pretrain-64dim:latest', seed=1, mem_switched=False, num_compressed_seeds=50, compressed_len=250, block_size=250, max_set_len=1000, num_induce=0, embed_dim=64, num_layers=8, num_heads=8, mem_len=250, compressed_mem_len=250, dropout_rate=0.01, num_seeds=1, use_layernorm=True, pre_layernorm=True, use_keras_mha=True, set_len=1000, batches_per_epoch=20, validation_batch_size=5, save_to='StrXL_Compressed_{seed}_{mem_len}_{num_compressed_seeds}', batch_size=20, sub_batch_size=0, data_workers=1, run_eagerly=False, use_dynamic_memory=False, wandb_project='StrXL_Compressed', wandb_name=None, wandb_group=None, wandb_mode='online', resume=None, initial_epoch=0, epochs=750)
Using GPU Strategy. Selected GPUs: [0]
Sample './artifacts/nachusa-dna:v0/Wes7-PCRblank1_S8_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wes24-PCRblank2_S25_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wes44-PCRblank3_S45_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wes7-PCRblank1_S8_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wesley049-SB-100420_S188_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wes24-PCRblank2_S25_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Sample './artifacts/nachusa-dna:v0/Wesley056-NegCtrl_S195_L001_R1_001.db' does not contain enough sequences. This sample will be ignored.
Epoch 1/750
 1/20 [>.............................] - ETA: 20:52 - loss: 5.7668 - sparse_categorical_accuracy: 0.0000e+00 2/20 [==>...........................] - ETA: 1:54 - loss: 5.6757 - sparse_categorical_accuracy: 0.0000e+00  3/20 [===>..........................] - ETA: 1:48 - loss: 5.7111 - sparse_categorical_accuracy: 0.0000e+00 4/20 [=====>........................] - ETA: 1:41 - loss: 5.6773 - sparse_categorical_accuracy: 0.0125     5/20 [======>.......................] - ETA: 1:35 - loss: 5.6852 - sparse_categorical_accuracy: 0.0100 6/20 [========>.....................] - ETA: 1:28 - loss: 5.6942 - sparse_categorical_accuracy: 0.0083 7/20 [=========>....................] - ETA: 1:22 - loss: 5.6548 - sparse_categorical_accuracy: 0.0143 8/20 [===========>..................] - ETA: 1:16 - loss: 5.6239 - sparse_categorical_accuracy: 0.0125 9/20 [============>.................] - ETA: 1:09 - loss: 5.6057 - sparse_categorical_accuracy: 0.011110/20 [==============>...............] - ETA: 1:03 - loss: 5.5909 - sparse_categorical_accuracy: 0.010011/20 [===============>..............] - ETA: 57s - loss: 5.6202 - sparse_categorical_accuracy: 0.0136 12/20 [=================>............] - ETA: 50s - loss: 5.6120 - sparse_categorical_accuracy: 0.012513/20 [==================>...........] - ETA: 44s - loss: 5.6012 - sparse_categorical_accuracy: 0.011514/20 [====================>.........] - ETA: 38s - loss: 5.5855 - sparse_categorical_accuracy: 0.014315/20 [=====================>........] - ETA: 31s - loss: 5.5823 - sparse_categorical_accuracy: 0.013316/20 [=======================>......] - ETA: 25s - loss: 5.5857 - sparse_categorical_accuracy: 0.012517/20 [========================>.....] - ETA: 19s - loss: 5.5859 - sparse_categorical_accuracy: 0.011818/20 [==========================>...] - ETA: 12s - loss: 5.5925 - sparse_categorical_accuracy: 0.011119/20 [===========================>..] - ETA: 6s - loss: 5.5908 - sparse_categorical_accuracy: 0.0105 20/20 [==============================] - ETA: 0s - loss: 5.5906 - sparse_categorical_accuracy: 0.012520/20 [==============================] - 228s 9s/step - loss: 5.5906 - sparse_categorical_accuracy: 0.0125 - val_loss: 5.7239 - val_sparse_categorical_accuracy: 0.0000e+00
Epoch 2/750
 1/20 [>.............................] - ETA: 2:03 - loss: 5.5242 - sparse_categorical_accuracy: 0.0000e+00 2/20 [==>...........................] - ETA: 1:54 - loss: 5.4925 - sparse_categorical_accuracy: 0.0000e+00 3/20 [===>..........................] - ETA: 1:48 - loss: 5.5493 - sparse_categorical_accuracy: 0.0000e+00 4/20 [=====>........................] - ETA: 1:41 - loss: 5.5270 - sparse_categorical_accuracy: 0.0125     5/20 [======>.......................] - ETA: 1:35 - loss: 5.5082 - sparse_categorical_accuracy: 0.0100 6/20 [========>.....................] - ETA: 1:29 - loss: 5.5536 - sparse_categorical_accuracy: 0.0083 7/20 [=========>....................] - ETA: 1:22 - loss: 5.5364 - sparse_categorical_accuracy: 0.0071 8/20 [===========>..................] - ETA: 1:16 - loss: 5.5567 - sparse_categorical_accuracy: 0.0063 9/20 [============>.................] - ETA: 1:09 - loss: 5.5527 - sparse_categorical_accuracy: 0.005610/20 [==============>...............] - ETA: 1:03 - loss: 5.5484 - sparse_categorical_accuracy: 0.005011/20 [===============>..............] - ETA: 57s - loss: 5.5537 - sparse_categorical_accuracy: 0.0045 12/20 [=================>............] - ETA: 50s - loss: 5.5613 - sparse_categorical_accuracy: 0.004213/20 [==================>...........] - ETA: 44s - loss: 5.5603 - sparse_categorical_accuracy: 0.003814/20 [====================>.........] - ETA: 38s - loss: 5.5582 - sparse_categorical_accuracy: 0.003615/20 [=====================>........] - ETA: 31s - loss: 5.5665 - sparse_categorical_accuracy: 0.003316/20 [=======================>......] - ETA: 25s - loss: 5.5429 - sparse_categorical_accuracy: 0.003117/20 [========================>.....] - ETA: 19s - loss: 5.5411 - sparse_categorical_accuracy: 0.002918/20 [==========================>...] - ETA: 12s - loss: 5.5280 - sparse_categorical_accuracy: 0.005619/20 [===========================>..] - ETA: 6s - loss: 5.5205 - sparse_categorical_accuracy: 0.0053 20/20 [==============================] - ETA: 0s - loss: 5.5147 - sparse_categorical_accuracy: 0.005020/20 [==============================] - 157s 8s/step - loss: 5.5147 - sparse_categorical_accuracy: 0.0050 - val_loss: 5.4043 - val_sparse_categorical_accuracy: 0.0100
Epoch 3/750
 1/20 [>.............................] - ETA: 2:04 - loss: 5.6113 - sparse_categorical_accuracy: 0.0000e+00 2/20 [==>...........................] - ETA: 1:54 - loss: 5.4699 - sparse_categorical_accuracy: 0.0000e+00 3/20 [===>..........................] - ETA: 1:47 - loss: 5.4989 - sparse_categorical_accuracy: 0.0000e+00 4/20 [=====>........................] - ETA: 1:41 - loss: 5.5019 - sparse_categorical_accuracy: 0.0000e+00 5/20 [======>.......................] - ETA: 1:35 - loss: 5.5226 - sparse_categorical_accuracy: 0.0000e+00 6/20 [========>.....................] - ETA: 1:28 - loss: 5.5145 - sparse_categorical_accuracy: 0.0000e+00 7/20 [=========>....................] - ETA: 1:22 - loss: 5.5042 - sparse_categorical_accuracy: 0.0000e+00 8/20 [===========>..................] - ETA: 1:16 - loss: 5.5008 - sparse_categorical_accuracy: 0.0000e+00 9/20 [============>.................] - ETA: 1:09 - loss: 5.4907 - sparse_categorical_accuracy: 0.0000e+0010/20 [==============>...............] - ETA: 1:03 - loss: 5.5041 - sparse_categorical_accuracy: 0.0000e+0011/20 [===============>..............] - ETA: 57s - loss: 5.5056 - sparse_categorical_accuracy: 0.0045     12/20 [=================>............] - ETA: 50s - loss: 5.4900 - sparse_categorical_accuracy: 0.004213/20 [==================>...........] - ETA: 44s - loss: 5.4924 - sparse_categorical_accuracy: 0.003814/20 [====================>.........] - ETA: 38s - loss: 5.4852 - sparse_categorical_accuracy: 0.003615/20 [=====================>........] - ETA: 31s - loss: 5.4791 - sparse_categorical_accuracy: 0.006716/20 [=======================>......] - ETA: 25s - loss: 5.4645 - sparse_categorical_accuracy: 0.006317/20 [========================>.....] - ETA: 19s - loss: 5.4665 - sparse_categorical_accuracy: 0.005918/20 [==========================>...] - ETA: 12s - loss: 5.4520 - sparse_categorical_accuracy: 0.005619/20 [===========================>..] - ETA: 6s - loss: 5.4426 - sparse_categorical_accuracy: 0.0053 20/20 [==============================] - ETA: 0s - loss: 5.4309 - sparse_categorical_accuracy: 0.005020/20 [==============================] - 157s 8s/step - loss: 5.4309 - sparse_categorical_accuracy: 0.0050 - val_loss: 5.3080 - val_sparse_categorical_accuracy: 0.0100
Epoch 4/750
 1/20 [>.............................] - ETA: 2:03 - loss: 5.2973 - sparse_categorical_accuracy: 0.1000 2/20 [==>...........................] - ETA: 1:54 - loss: 5.3581 - sparse_categorical_accuracy: 0.0500 3/20 [===>..........................] - ETA: 1:48 - loss: 5.3882 - sparse_categorical_accuracy: 0.0333 4/20 [=====>........................] - ETA: 1:41 - loss: 5.3414 - sparse_categorical_accuracy: 0.0250 5/20 [======>.......................] - ETA: 1:35 - loss: 5.3507 - sparse_categorical_accuracy: 0.0200 6/20 [========>.....................] - ETA: 1:29 - loss: 5.3387 - sparse_categorical_accuracy: 0.0167 7/20 [=========>....................] - ETA: 1:22 - loss: 5.3085 - sparse_categorical_accuracy: 0.0143 8/20 [===========>..................] - ETA: 1:16 - loss: 5.2711 - sparse_categorical_accuracy: 0.0188 9/20 [============>.................] - ETA: 1:09 - loss: 5.2483 - sparse_categorical_accuracy: 0.016710/20 [==============>...............] - ETA: 1:03 - loss: 5.2455 - sparse_categorical_accuracy: 0.015011/20 [===============>..............] - ETA: 57s - loss: 5.2180 - sparse_categorical_accuracy: 0.0136 12/20 [=================>............] - ETA: 50s - loss: 5.2266 - sparse_categorical_accuracy: 0.012513/20 [==================>...........] - ETA: 44s - loss: 5.2317 - sparse_categorical_accuracy: 0.011514/20 [====================>.........] - ETA: 38s - loss: 5.2433 - sparse_categorical_accuracy: 0.010715/20 [=====================>........] - ETA: 31s - loss: 5.2273 - sparse_categorical_accuracy: 0.013316/20 [=======================>......] - ETA: 25s - loss: 5.2199 - sparse_categorical_accuracy: 0.015617/20 [========================>.....] - ETA: 19s - loss: 5.2314 - sparse_categorical_accuracy: 0.014718/20 [==========================>...] - ETA: 12s - loss: 5.2258 - sparse_categorical_accuracy: 0.013919/20 [===========================>..] - ETA: 6s - loss: 5.2240 - sparse_categorical_accuracy: 0.0132 